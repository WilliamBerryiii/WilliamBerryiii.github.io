---
layout: post
title: HBase, Thrift, & C# - Batch Reads
date: '2014-05-17T23:38:00.003-07:00'
author: William Berry
tags: 
modified_time: '2014-05-17T23:47:15.197-07:00'
blogger_id: tag:blogger.com,1999:blog-4707687462195457004.post-1027936388976476719
blogger_orig_url: http://www.lucidmotions.net/2014/05/hbase-thrift-c-batch-reads.html
---

Continuing the epic series on Hbase, Thrift and C#, this installment is the code for a batch scanner by leveraging inheritance and generics to provide a broad based solution. &nbsp;If you have not done so please check out the other parts of the series:<br /><br />Part 1 -&nbsp;<a class="GCUXF0KCPB" href="http://www.lucidmotions.net/2014/04/nuget-code-generation-jenkins-thrift-hbase.html" style="border: 0px; color: #1155cc; display: inline-block; font-family: Arial, Helvetica, sans-serif; font-size: 13px; margin: 0px 10px 0px 0px; max-width: 100%; overflow: hidden; padding: 0px; text-decoration: none; text-overflow: ellipsis; vertical-align: baseline; white-space: nowrap; width: auto;">NuGet Servers, HBase, Thrift Code Generation and one sweet Jenkins CI Build</a><br />Part 2 -&nbsp;<a class="GCUXF0KCPB" href="http://www.lucidmotions.net/2014/05/hbase-thrift-csharp-first-connections.html" style="border: 0px; color: #1155cc; display: inline-block; font-family: Arial, Helvetica, sans-serif; font-size: 13px; margin: 0px 10px 0px 0px; max-width: 100%; overflow: hidden; padding: 0px; text-decoration: none; text-overflow: ellipsis; vertical-align: baseline; white-space: nowrap; width: auto;">HBase, Thrift &amp; C# - First Connections</a><br />Part 3 -&nbsp;<a class="GCUXF0KCPB" href="http://www.lucidmotions.net/2014/05/hbase-thrift-csharp-session-management.html" style="border: 0px; color: #1155cc; display: inline-block; font-family: Arial, Helvetica, sans-serif; font-size: 13px; margin: 0px 10px 0px 0px; max-width: 100%; overflow: hidden; padding: 0px; text-decoration: none; text-overflow: ellipsis; vertical-align: baseline; white-space: nowrap; width: auto;">HBase, Thrift, &amp; C# - Managing Sessions</a><br />Part 4 - <a href="http://www.lucidmotions.net/2014/05/hbase-thrift-csharp-generic-row-scanner.html" style="border: 0px; color: #1155cc; display: inline-block; font-family: Arial, Helvetica, sans-serif; font-size: 13px; margin: 0px 10px 0px 0px; max-width: 100%; overflow: hidden; padding: 0px; text-decoration: none; text-overflow: ellipsis; vertical-align: baseline; white-space: nowrap; width: auto;" target="_blank">HBase, Thrift, &amp; C# - First Scanner and Leveraging Generics</a><br /><br /><div style="text-align: center;">***<br /><br /></div>Feeling the PAIN of single reads off HBase, I hacked up a little method to allow for batch reads off the HBase Thrift interface. &nbsp;Like the other versions in my last HBase post, this one makes use of the table scanner.<br /><br /><div><pre><span style="color: teal;">  1</span> <span style="color: blue;">public</span> <span style="color: blue;">virtual</span> List&lt;T&gt; BatchSelectWithPrefixScanner&lt;T&gt;(<span style="color: blue;">string</span> identifier, <span style="color: blue;">int</span> batchSize)<br /><span style="color: teal;">  2</span>     where T : IHBaseEntity, <span style="color: blue;">new</span>() <br /><span style="color: teal;">  3</span> { <br /><span style="color: teal;">  4</span>     var col = <span style="color: blue;">new</span> List&lt;<span style="color: blue;">byte</span>[]&gt;(); <br /><span style="color: teal;">  5</span>     col.AddRange(Columns.Select(x =&gt; x.GetBytes())); <br /><span style="color: teal;">  6</span>   <br /><span style="color: teal;">  7</span>     var tableName = <span style="color: blue;">string</span>.Format(TableNameTemplate, RetailerId);<br /><span style="color: teal;">  8</span>   <br /><span style="color: teal;">  9</span>     var scanner = HBaseClient.scannerOpenWithPrefix( <br /><span style="color: teal;"> 10</span>         tableName.GetBytes(), <br /><span style="color: teal;"> 11</span>         identifier.GetBytes(), <br /><span style="color: teal;"> 12</span>         col, <br /><span style="color: teal;"> 13</span>         <span style="color: blue;">new</span> Dictionary&lt;<span style="color: blue;">byte</span>[], <span style="color: blue;">byte</span>[]&gt;() <br /><span style="color: teal;"> 14</span>         ); <br /><span style="color: teal;"> 15</span>     <span style="color: blue;">return</span> GetBatchRows&lt;T&gt;(batchSize, scanner); <br /><span style="color: teal;"> 16</span> }</pre></div><br />Yet again we have leveraged generics to return a List&lt;T&gt;. <br /><br />