---
layout: post
title: Getting Node List from UpGuard using Powershell v3.0+
date: '2015-09-13T14:51:00.002-07:00'
author: William Berry
tags:
- Powershell
- DevOps
- UpGuard
modified_time: '2016-01-28T09:51:54.697-08:00'
blogger_id: tag:blogger.com,1999:blog-4707687462195457004.post-5057004279118242246
blogger_orig_url: http://www.lucidmotions.net/2015/09/getting-node-list-from-upguard.html
---

I'm completely perplexed by people who dislike Powershell. &nbsp;As someone who has built 1,000+ line Powershell deployment scripts, the scripting language can be a bit like bacon flavored chocolate; you'll try it, some folks swear by it, but for the most part my conclusion is ... "meh". &nbsp;That said, Powershell as a SHELL is outstanding. &nbsp;Frankly it smokes any experience I've ever had on the Unix/Linux side of the fence and it's got everything to do with direct access to .Net. &nbsp;So let's put the scripting language aside and look at some things you can do with the shell and my new favorite tool&nbsp;UpGuard.<br /><div><br /></div><div style="text-align: center;">***</div><div style="text-align: center;"><br /></div><div style="text-align: left;">Connecting to&nbsp;UpGuard&nbsp;from Powershell and pulling down the node list is very straight forward. &nbsp;Though you'll&nbsp;find some Powershell 2.0 examples in the <a href="https://support.upguard.com/hc/en-us/sections/200706424-API-Reference">API section of the UpGuard site</a>, the following is an approach using the Powershell v3.0+ Cmdlet <a href="https://technet.microsoft.com/en-us/library/hh849971(v=wps.630).aspx">Invoke-RestMethod</a> which will automatically deserialize the JSON response into objects - super cool!<br /><br /></div><script src="https://gist.github.com/WilliamBerryiii/7dc2c9004647c4e486a4.js"></script> <br /><div><br />The&nbsp;UpGuard&nbsp;API rightly enforces pagination, so the above script uses a while loop to pull out the nodes from&nbsp;each Cmdlet response and adds them to a master array, breaking when there are no further nodes in the response.<br /><br />Happy Scripting!</div>